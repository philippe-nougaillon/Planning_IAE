<% old_responsabilite = f.object.titre.present? %>
<div class="nested-form-wrapper" data-new-record="<%= f.object.new_record? %>">
  <div class="flex flex-wrap shadow pb-4 mb-4 w-full">
    <div class="sm:w-2/12 px-4">
      <div class="form-control">
        <%= f.label :debut, 'Date *' %>
        <%= f.date_field :debut, class: 'input input-bordered input-sm w-full', required: true %>
      </div>
    </div>

    <div class="sm:w-3/12 px-4">
      <div class="form-control">
        <%= f.label :intervenant_id, 'Intervenant *' %>
        <%= f.collection_select :intervenant_id, 
                                        Intervenant.permanents,
                                        :id,
                                        :nom_prenom_status,
                                        {include_blank: true}, class: "select select-bordered select-sm w-full",
                                        required: true %>
      </div>
    </div> 

    <div class="sm:w-5/12 px-4">
      <div class="form-control">
        <%= f.label :activite_id, old_responsabilite ? 'Activité' : 'Activité *' %>
        <%= f.select :activite_id, grouped_options_for_select(VacationActivite.for_select, f.object.activite_id), {include_blank: true}, class: "select select-bordered select-sm w-full", required: !old_responsabilite %>
      </div>
    </div> 

    <div class="sm:w-2/12 px-4">
      <div class="form-control">
        <%= f.label :heures, "Forfait *", class: 'whitespace-nowrap' %>
        <%= f.number_field :heures, class: 'input input-bordered input-sm w-full', disabled: true %>
      </div>
    </div>

    <div class="sm:w-full px-4">
      <div class="form-control">
        <%= f.label :commentaires %>
        <%= f.text_area :commentaires, class: 'textarea textarea-bordered textarea-sm w-full' %>
      </div>
    </div>

    <div class="sm:w-4/12 px-4">
      <div class="form-control">
        <%= f.label :titre, 'Activité antérieure à 2026' %>
        <%= f.select :titre, Intervenant.liste_responsabilites, {include_blank: true}, class: "select select-bordered select-sm w-full", disabled: true %>
      </div>
    </div>

    <div class="sm:w-8/12 px-4 self-end">
      <button type="button" data-action="nested-form#remove" class="btn btn-sm float-end self-end">[X]</button>
      <%= f.hidden_field :_destroy %>
    </div>
  </div>
</div>